<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ë„ì¿„ ì—¬í–‰ ê°€ì´ë“œ</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --bg-color: #f8f9f6;
  --text-color: #333;
  --card-bg: #fff;
  --primary: #5aa897;
  --primary-dark: #4a8a7f;
  --accent: #e63946;
  --nav-bg: #fff;
  --shadow: 0 2px 10px rgba(0,0,0,0.1);
  --muted: #777;
  --border: rgba(0,0,0,0.1);
}

body.dark-mode {
  --bg-color: #121418;
  --text-color: #f3f3f3;
  --card-bg: #1b1e24;
  --primary: #7bc8b5;
  --primary-dark: #5aa897;
  --nav-bg: #191c23;
  --shadow: 0 2px 15px rgba(0,0,0,0.7);
  --muted: #aaa;
  --border: rgba(255,255,255,0.1);
}

*{box-sizing:border-box;margin:0;padding:0}
body{font-family:'Noto Sans KR',sans-serif;background:var(--bg-color);color:var(--text-color);overflow-x:hidden;line-height:1.6}

/* í”„ë¦¬ë¡œë” */
#preloader{position:fixed;inset:0;background:radial-gradient(circle at top,#5aa897 0,#121418 55%);display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:5000;transition:opacity .4s,visibility .4s}
#preloader.hide{opacity:0;visibility:hidden;pointer-events:none}
.loader-logo{font-size:26px;font-weight:700;color:#fff;letter-spacing:4px;margin-bottom:16px}
.loader-bar{width:160px;height:4px;border-radius:999px;background:rgba(255,255,255,0.25);overflow:hidden;position:relative}
.loader-bar::before{content:"";position:absolute;inset:0;width:40%;background:linear-gradient(90deg,#fff,#f9d976);animation:loadingSlide 1.2s infinite ease-in-out}
@keyframes loadingSlide{0%{transform:translateX(-100%)}50%{transform:translateX(60%)}100%{transform:translateX(160%)}}

/* ë„¤ë¹„ê²Œì´ì…˜ */
.navbar{position:fixed;top:0;left:0;width:100%;height:70px;background:var(--nav-bg);box-shadow:var(--shadow);display:flex;align-items:center;justify-content:space-between;padding:0 60px;z-index:2000;transition:background .3s}
.navbar h1{color:var(--primary);font-size:22px;cursor:pointer;transition:transform .2s}
.navbar h1:hover{transform:scale(1.05)}
.nav-menu{display:flex;gap:30px;align-items:center}
.nav-menu a{color:var(--text-color);text-decoration:none;font-weight:600;font-size:15px;transition:color .3s;position:relative}
.nav-menu a::after{content:'';position:absolute;bottom:-5px;left:0;width:0;height:2px;background:var(--primary);transition:width .3s}
.nav-menu a:hover::after,.nav-menu a.active::after{width:100%}
.nav-menu a:hover,.nav-menu a.active{color:var(--primary)}
.dropdown{position:relative}
.dropdown-content{position:absolute;top:50px;left:0;background:var(--card-bg);border-radius:12px;box-shadow:var(--shadow);width:180px;opacity:0;visibility:hidden;transform:translateY(-10px);transition:all .3s;overflow:hidden;z-index:2500}
.dropdown:hover .dropdown-content{opacity:1;visibility:visible;transform:translateY(0)}
.dropdown-content a{display:block;padding:12px 16px;text-decoration:none;color:var(--text-color);font-weight:500;border-bottom:1px solid var(--border);transition:background .2s}
.dropdown-content a:last-child{border-bottom:none}
.dropdown-content a:hover{background:rgba(90,168,151,0.08);color:var(--primary)}

/* ê²€ìƒ‰ */
.search-box{position:relative;margin-right:12px}
.search-box input{padding:8px 35px 8px 12px;border:1.5px solid var(--border);border-radius:20px;outline:none;width:200px;transition:all .3s;background:var(--bg-color);color:var(--text-color)}
.search-box input:focus{width:260px;border-color:var(--primary);box-shadow:0 0 0 3px rgba(90,168,151,0.1)}
.search-icon{position:absolute;right:12px;top:50%;transform:translateY(-50%);color:var(--muted);pointer-events:none;font-size:16px}
.suggestions{position:absolute;top:45px;left:0;width:100%;background:var(--card-bg);border-radius:10px;box-shadow:var(--shadow);overflow:hidden;display:none;z-index:3000;max-height:300px;overflow-y:auto}
.suggestions div{padding:10px 12px;cursor:pointer;font-size:14px;transition:background .2s;border-bottom:1px solid var(--border)}
.suggestions div:last-child{border-bottom:none}
.suggestions div:hover{background:rgba(90,168,151,0.08);color:var(--primary)}

/* ë‹¤í¬ëª¨ë“œ í† ê¸€ */
.theme-toggle{border:none;background:transparent;cursor:pointer;font-size:20px;margin-right:8px;padding:8px;border-radius:50%;transition:all .3s}
.theme-toggle:hover{background:rgba(90,168,151,0.1);transform:rotate(20deg)}
.theme-toggle.sun{color:#ffd84d}
.theme-toggle.moon{color:var(--primary-dark)}

/* ìŠ¤í¬ë¡¤ ì§„í–‰ë°” */
.scroll-progress{position:fixed;top:70px;left:0;width:0;height:3px;background:linear-gradient(90deg,#5aa897,#e8b44f);z-index:1999;transition:width .1s}

/* ë°°ë„ˆ */
.hero{position:relative;margin-top:73px;height:480px;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);display:flex;align-items:center;justify-content:center;color:#fff;overflow:hidden}
.hero::before{content:"";position:absolute;inset:0;background:url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320"><path fill="%23ffffff" fill-opacity="0.1" d="M0,96L48,112C96,128,192,160,288,160C384,160,480,128,576,122.7C672,117,768,139,864,154.7C960,171,1056,181,1152,165.3C1248,149,1344,107,1392,85.3L1440,64L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path></svg>') bottom center no-repeat;background-size:cover;animation:waveAnimation 8s ease-in-out infinite}
@keyframes waveAnimation{0%,100%{transform:translateX(0)}50%{transform:translateX(-20px)}}
.hero::after{content:"";position:absolute;inset:0;background:rgba(0,0,0,0.3)}
.hero-text{position:relative;text-align:center;z-index:10;animation:fadeInUp .8s ease-out}
@keyframes fadeInUp{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}
.hero-text h2{font-size:46px;margin-bottom:10px;text-shadow:2px 2px 8px rgba(0,0,0,0.3)}
.hero-text p{font-size:20px;opacity:.9;text-shadow:1px 1px 4px rgba(0,0,0,0.3)}
.weather-widget{position:absolute;right:28px;bottom:30px;padding:12px 18px;border-radius:20px;background:rgba(0,0,0,0.5);font-size:13px;color:#f5f5f5;backdrop-filter:blur(8px);z-index:10;transition:transform .3s;cursor:pointer}
.weather-widget:hover{transform:translateY(-3px);background:rgba(0,0,0,0.6)}

/* ë¹ ë¥¸ í†µê³„ */
.quick-stats{max-width:1100px;margin:30px auto 0;padding:0 20px;display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px}
.stat-card{background:var(--card-bg);padding:20px;border-radius:14px;box-shadow:var(--shadow);text-align:center;transition:all .3s;cursor:pointer}
.stat-card:hover{transform:translateY(-5px);box-shadow:0 8px 20px rgba(0,0,0,0.15)}
.stat-number{font-size:32px;font-weight:700;color:var(--primary);margin-bottom:5px}
.stat-label{font-size:20px;color:var(--muted)}

/* ì¼ìˆ˜ ì„ íƒ ë²„íŠ¼ */
.day-selector{Display:flex;flex-wrap:wrap;gap:10px}
.day-btn{border-radius:20px;border:2px solid var(--border);padding:8px 20px;font-size:14px;font-weight:600;background:var(--card-bg);color:var(--text-color);cursor:pointer;transition:all .3s;min-width:70px}
.day-btn:hover{border-color:var(--primary);background:rgba(90,168,151,0.1);transform:translateY(-2px)}
.day-btn.active{background:var(--primary);color:#fff;border-color:var(--primary);box-shadow:0 4px 8px rgba(90,168,151,0.3)}

/* í”Œë˜ë„ˆ */
.planner{max-width:1100px;margin:35px auto 5px;padding:0 20px}
.planner-header{display:flex;flex-wrap:wrap;justify-content:space-between;align-items:center;gap:12px}
.planner-header h2{font-size:32px;display:flex;align-items:center;gap:10px}
.planner-toggle-btn{border:none;background:var(--primary);color:#fff;padding:10px 20px;border-radius:20px;cursor:pointer;font-size:14px;font-weight:600;box-shadow:var(--shadow);transition:all .3s}
.planner-toggle-btn:hover{background:var(--primary-dark);transform:translateY(-2px)}
.planner-box{background:var(--card-bg);margin-top:15px;border-radius:14px;padding:0 18px;max-height:0;overflow:hidden;box-shadow:var(--shadow);transition:all .4s}
.planner-box.open{max-height:800px;padding-top:18px;padding-bottom:22px}
.planner-subtitle{margin-top:8px;font-size:14px;color:var(--muted);line-height:1.5}
.keyword-box{display:flex;flex-wrap:wrap;gap:10px;margin:15px 0 12px}
.keyword-box button{border-radius:20px;border:2px solid var(--primary);padding:8px 16px;font-size:13px;background:transparent;cursor:pointer;color:var(--primary);font-weight:600;transition:all .3s}
.keyword-box button:hover{background:rgba(90,168,151,0.1);transform:translateY(-2px)}
.keyword-box button.active{background:var(--primary);color:#fff;box-shadow:0 4px 8px rgba(90,168,151,0.3)}
.planner-generate-btn{border:none;background:var(--accent);color:#fff;padding:10px 20px;border-radius:20px;font-size:14px;font-weight:600;cursor:pointer;margin-bottom:12px;transition:all .3s;box-shadow:0 4px 8px rgba(230,57,70,0.3)}
.planner-generate-btn:hover{background:#d62839;transform:translateY(-2px)}
.planner-result{margin-top:10px;animation:fadeIn .5s}
@keyframes fadeIn{from{opacity:0}to{opacity:1}}
.planner-table{width:100%;border-collapse:collapse;font-size:14px;margin-top:10px}
.planner-table th{background:var(--primary);color:#fff;padding:12px;text-align:left;font-weight:600}
.planner-table td{background:rgba(90,168,151,0.05);padding:12px;border-bottom:1px solid var(--border)}
.planner-table tr:last-child td{border-bottom:none}

/* í•„í„°ë°” */
.filter-bar{max-width:1100px;margin:25px auto 10px;padding:0 20px;display:flex;flex-wrap:wrap;gap:10px;align-items:center}
.filter-bar span{font-size:15px;font-weight:600;color:var(--text-color);margin-right:5px}
.filter-bar button{border-radius:20px;border:2px solid var(--border);padding:8px 18px;font-size:13px;font-weight:600;background:var(--card-bg);color:var(--text-color);cursor:pointer;transition:all .3s}
.filter-bar button:hover{border-color:var(--primary);background:rgba(90,168,151,0.1);transform:translateY(-2px)}
.filter-bar button.active{background:var(--primary);color:#fff;border-color:var(--primary);box-shadow:0 4px 8px rgba(90,168,151,0.3)}

/* ì¹´ë“œ ê·¸ë¦¬ë“œ */
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:30px;padding:28px 80px 160px;max-width:1200px;margin:0 auto}
.card{position:relative;border-radius:16px;overflow:hidden;box-shadow:var(--shadow);cursor:pointer;opacity:0;transform:translateY(30px);transition:all .5s;background:var(--card-bg)}
.card.visible{opacity:1;transform:translateY(0)}
.card:hover{transform:translateY(-8px) scale(1.02);box-shadow:0 12px 28px rgba(0,0,0,0.2)}
.card img{width:100%;height:250px;object-fit:cover;filter:brightness(0.9);transition:all .3s}
.card:hover img{filter:brightness(1);transform:scale(1.05)}
.card-overlay{position:absolute;bottom:0;left:0;right:0;background:linear-gradient(to top,rgba(0,0,0,0.8) 0%,transparent 100%);padding:20px;transition:transform .3s}
.card h3{color:#fff;font-size:1.4em;text-shadow:0 2px 8px rgba(0,0,0,0.8);margin:0 0 5px}
.card-category{color:rgba(255,255,255,0.8);font-size:.85em;text-shadow:0 1px 4px rgba(0,0,0,0.6)}
.card .bookmark{position:absolute;top:15px;right:15px;font-size:24px;color:#fff;text-shadow:0 2px 6px rgba(0,0,0,0.8);cursor:pointer;user-select:none;transition:all .2s;z-index:10}
.card .bookmark:hover{transform:scale(1.2)}
.card .bookmark.active{color:#ffd84d;animation:bookmarkPop .3s}
@keyframes bookmarkPop{0%,100%{transform:scale(1)}50%{transform:scale(1.3)}}

/* ìƒì„¸ íŒ¨ë„ */
.detail-panel{position:fixed;left:0;bottom:-100%;width:100%;background:var(--card-bg);border-radius:20px 20px 0 0;box-shadow:0 -6px 30px rgba(0,0,0,0.4);transition:bottom .4s cubic-bezier(0.4,0,0.2,1);z-index:1500;max-height:65vh;overflow-y:auto}
.detail-panel.show{bottom:0}
.detail-content{padding:25px 30px 30px}
.detail-content h2{color:var(--primary);margin-top:5px;font-size:28px;margin-bottom:8px}
.detail-sub{font-size:14px;color:var(--muted);margin-bottom:15px;font-style:italic}
.detail-summary{line-height:1.8;font-size:15px;margin-bottom:20px;color:var(--text-color)}
.detail-info{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:15px;margin-bottom:20px}
.info-item{background:rgba(90,168,151,0.08);padding:12px 15px;border-radius:10px;border-left:3px solid var(--primary)}
.info-item strong{color:var(--primary);display:block;margin-bottom:5px;font-size:14px}
.info-item span{font-size:13px;color:var(--text-color)}
.detail-buttons{display:flex;gap:12px;margin-top:20px;justify-content:center}
.detail-btn{flex:1;max-width:200px;padding:14px 0;text-align:center;border-radius:25px;font-weight:600;font-size:15px;cursor:pointer;transition:all .3s;text-decoration:none;border:none}
.detail-btn.close{background:var(--card-bg);color:var(--text-color);border:2px solid var(--border)}
.detail-btn.close:hover{background:rgba(90,168,151,0.1);border-color:var(--primary);transform:translateY(-2px)}
.detail-btn.more{background:linear-gradient(135deg,var(--primary),var(--primary-dark));color:#fff;box-shadow:0 4px 12px rgba(90,168,151,0.3)}
.detail-btn.more:hover{transform:translateY(-2px);box-shadow:0 6px 16px rgba(90,168,151,0.4)}

/* íŒ¨ë„ ì˜¤ë²„ë ˆì´ */
.panel-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.5);opacity:0;visibility:hidden;transition:all .3s;z-index:1400}
.panel-overlay.show{opacity:1;visibility:visible}

/* í”Œë¡œíŒ… ë²„íŠ¼ */
.floating-back{position:fixed;bottom:25px;right:25px;background:var(--primary);color:#fff;font-weight:600;padding:12px 20px;border-radius:25px;box-shadow:0 3px 10px rgba(0,0,0,0.2);cursor:pointer;transition:all .3s;z-index:3000}
.floating-back:hover{background:var(--primary-dark);transform:scale(1.05)}

/* ë¦¬ë·° í‘œì‹œ ì•„ì´í…œ (detail-content ì•ˆì—ì„œ ì‚¬ìš©) */
.detail-content .review-item {
  background: var(--card-bg);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 15px 20px;
  margin-bottom: 15px;
  box-shadow: var(--shadow);
}
.detail-content .review-item h4 { color: var(--primary); margin-bottom: 6px; }
.detail-content .review-item p { margin: 4px 0; }
.detail-content .review-item small { color: var(--muted); }

/* ë°˜ì‘í˜• */
@media(max-width:960px){
  .navbar{padding:0 16px}
  .nav-menu{gap:16px}
  .hero{height:360px}
  .hero-text h2{font-size:32px}
  .hero-text p{font-size:16px}
  .grid{padding:24px 20px 120px}
  .quick-stats{grid-template-columns:repeat(2,1fr)}
  .detail-info{grid-template-columns:1fr}
}
@media(max-width:640px){
  .nav-menu a:nth-child(3){display:none}
  .search-box input{width:150px}
  .search-box input:focus{width:190px}
  .planner-header{flex-direction:column;align-items:flex-start}
  .floating-back{bottom:18px;right:18px;padding:10px 16px}
  .quick-stats{grid-template-columns:1fr}
  .filter-bar{gap:8px}
  .detail-buttons{flex-direction:column;gap:10px}
  .detail-btn{max-width:100%}
}
</style>
</head>
<body>

<div id="preloader">
  <div class="loader-logo">TOKYO TRAVEL</div>
  <div class="loader-bar"></div>
</div>

<nav class="navbar">
  <h1 onclick="window.location.href='tokyo.html'">Tokyo Travel</h1>
  <div class="nav-menu">
    <a href="tokyo.html">í™ˆ</a>
    <div class="dropdown">
      <a href="#" class="active">ë„ì¿„ì†Œê°œ</a>
      <div class="dropdown-content">
        <a href="tokyo_history.html">ë„ì¿„ ì—­ì‚¬</a>
        <a href="tokyo_culture.html">ë¬¸í™”ì™€ ìƒí™œ</a>
        <a href="tokyo_structure.html">ë„ì‹œ êµ¬ì¡°</a>
      </div>
    </div>
    <a href="tokyo_map.html">ì§€ë„ë³´ê¸°</a>
  </div>
  <div style="display:flex;align-items:center">
    <button class="theme-toggle moon" id="themeToggle" aria-label="ë‹¤í¬ ëª¨ë“œ ì „í™˜">ğŸŒ™</button>
    <div class="search-box">
      <input type="text" id="searchInput" placeholder="ë„ì¿„ ì—¬í–‰ì§€ ê²€ìƒ‰...">
      <span class="search-icon">ğŸ”</span>
      <div class="suggestions" id="suggestions"></div>
    </div>
  </div>
</nav>

<div class="scroll-progress" id="scrollBar"></div>

<section id="mainContent">
  <section class="hero">
    <div class="hero-text">
      <h2>TOKYO TRAVEL GUIDE</h2>
      <p>Discover the Heart of Japan</p>
    </div>
    <div class="weather-widget" id="weatherWidget">
      ğŸŒ¤ï¸ í˜„ì¬ ë„ì¿„: 18â„ƒ / ë§‘ìŒ
    </div>
  </section>

  <section class="quick-stats">
    <div class="stat-card" onclick="filterFavorites()">
      <div class="stat-number" id="favoriteCount">0</div>
      <div class="stat-label">ë‚´ ì¦ê²¨ì°¾ê¸° ì—¬í–‰ì§€ ìˆ˜</div>
    </div>
    <div class="stat-card" onclick="showMyReviews()">
      <div class="stat-number" id="reviewCount">0</div>
      <div class="stat-label">ì‘ì„±ëœ ë¦¬ë·° ìˆ˜</div>
    </div>
  </section>

  <section class="planner">
    <div class="planner-header">
      <h2>ğŸ“… ë„ì¿„ ë§ì¶¤ ì—¬í–‰ ì½”ìŠ¤</h2>
      <button class="planner-toggle-btn" id="plannerToggle">ì½”ìŠ¤ í¼ì³ë³´ê¸°</button>
    </div>
    <div class="planner-box" id="plannerBox">
      <p class="planner-subtitle">ì—¬í–‰ ê¸°ê°„ê³¼ í‚¤ì›Œë“œë¥¼ ì„ íƒí•˜ì—¬ ë‚˜ë§Œì˜ ë§ì¶¤ ì½”ìŠ¤ë¥¼ ë§Œë“¤ì–´ë³´ì„¸ìš”.</p>
      
      <div style="margin:15px 0">
        <label style="font-weight:600;font-size:15px;color:var(--text-color);display:block;margin-bottom:8px">
          ğŸ—“ï¸ ì—¬í–‰ ê¸°ê°„ ì„ íƒ
        </label>
        <div class="day-selector" id="daySelector">
          <button class="day-btn" data-days="1">1ì¼</button>
          <button class="day-btn active" data-days="3">3ì¼</button>
          <button class="day-btn" data-days="5">5ì¼</button>
          <button class="day-btn" data-days="7">7ì¼</button>
        </div>
      </div>

      <div style="margin:15px 0">
        <label style="font-weight:600;font-size:15px;color:var(--text-color);display:block;margin-bottom:8px">
          ğŸ¯ ì—¬í–‰ í…Œë§ˆ ì„ íƒ
        </label>
        <div class="keyword-box" id="keywordBox">
          <button data-key="ì „í†µ">ğŸ¯ ì „í†µ</button>
          <button data-key="ì•¼ê²½">ğŸŒƒ ì•¼ê²½</button>
          <button data-key="ì‡¼í•‘">ğŸ›ï¸ ì‡¼í•‘</button>
          <button data-key="ìì—°">ğŸŒ³ ìì—°</button>
          <button data-key="ìŒì‹">ğŸœ ìŒì‹</button>
          <button data-key="ì˜ˆìˆ ">ğŸ¨ ì˜ˆìˆ </button>
          <button data-key="ì•¡í‹°ë¹„í‹°">ğŸ¢ ì•¡í‹°ë¹„í‹°</button>
        </div>
      </div>

      <button class="planner-generate-btn" id="plannerGenerate">âœ¨ ë§ì¶¤ ì½”ìŠ¤ ìƒì„±í•˜ê¸°</button>
      <div class="planner-result" id="plannerResult"></div>
    </div>
  </section>

  <div class="filter-bar">
    <span>ğŸ·ï¸ í…Œë§ˆ ì„ íƒ:</span>
    <button class="active" data-filter="all">ì „ì²´</button>
    <button data-filter="history">ì—­ì‚¬</button>
    <button data-filter="view">ì•¼ê²½Â·ì „ë§</button>
    <button data-filter="youth">ì ŠìŒÂ·ì‡¼í•‘</button>
  </div>

  <section class="grid">
    <div class="card" data-id="sensoji" data-category="history" onclick="cardClick(event,'sensoji')">
      <img src="tokyoimages/sensoji.jpg" alt="ì„¼ì†Œì§€" loading="lazy">
      <div class="card-overlay">
        <h3>ì„¼ì†Œì§€</h3>
        <div class="card-category">ğŸ¯ ì—­ì‚¬</div>
      </div>
      <div class="bookmark" data-id="sensoji">â˜…</div>
    </div>
    <div class="card" data-id="skytree" data-category="view" onclick="cardClick(event,'skytree')">
      <img src="tokyoimages/tokyoskytree.jpg" alt="ë„ì¿„ ìŠ¤ì¹´ì´íŠ¸ë¦¬" loading="lazy">
      <div class="card-overlay">
        <h3>ë„ì¿„ ìŠ¤ì¹´ì´íŠ¸ë¦¬</h3>
        <div class="card-category">ğŸŒƒ ì•¼ê²½Â·ì „ë§</div>
      </div>
      <div class="bookmark" data-id="skytree">â˜…</div>
    </div>
    <div class="card" data-id="shibuya" data-category="youth" onclick="cardClick(event,'shibuya')">
      <img src="tokyoimages/shibuya.jpg" alt="ì‹œë¶€ì•¼ êµì°¨ë¡œ" loading="lazy">
      <div class="card-overlay">
        <h3>ì‹œë¶€ì•¼ êµì°¨ë¡œ</h3>
        <div class="card-category">ğŸ›ï¸ ì ŠìŒÂ·ì‡¼í•‘</div>
      </div>
      <div class="bookmark" data-id="shibuya">â˜…</div>
    </div>
  </section>
</section>

<div class="panel-overlay" id="panelOverlay" onclick="closePanel()"></div>
<div id="detailPanel" class="detail-panel">
  <div class="detail-content" id="detailContent"></div>
</div>

<div class="floating-back" onclick="window.location.href='../kanto.html'">â† ê´€ë™ì§€ë°©</div>

<script>
// í”„ë¦¬ë¡œë”
window.addEventListener('load',()=>{
  document.getElementById('preloader').classList.add('hide');
});

// ë‹¤í¬ëª¨ë“œ
const themeToggle=document.getElementById('themeToggle');
const savedTheme=localStorage.getItem('tokyoTheme');
if(savedTheme==='dark'){
  document.body.classList.add('dark-mode');
  themeToggle.textContent='â˜€';
  themeToggle.classList.remove('moon');
  themeToggle.classList.add('sun');
}
themeToggle.addEventListener('click',()=>{
  document.body.classList.toggle('dark-mode');
  const isDark=document.body.classList.contains('dark-mode');
  themeToggle.textContent=isDark?'â˜€':'ğŸŒ™';
  themeToggle.classList.toggle('sun',isDark);
  themeToggle.classList.toggle('moon',!isDark);
  localStorage.setItem('tokyoTheme',isDark?'dark':'light');
});

// ìŠ¤í¬ë¡¤ ì§„í–‰ë°”
window.addEventListener('scroll',()=>{
  const docHeight=document.documentElement.scrollHeight-window.innerHeight;
  if(docHeight<=0)return;
  const scrolled=(window.scrollY/docHeight)*100;
  document.getElementById('scrollBar').style.width=scrolled+'%';
});

// í”Œë˜ë„ˆ í† ê¸€
const plannerToggle=document.getElementById('plannerToggle');
const plannerBox=document.getElementById('plannerBox');
plannerToggle.addEventListener('click',()=>{
  plannerBox.classList.toggle('open');
  plannerToggle.textContent=plannerBox.classList.contains('open')?'ì½”ìŠ¤ ì ‘ê¸°':'ì½”ìŠ¤ í¼ì³ë³´ê¸°';
});

// ì¼ìˆ˜ ì„ íƒ
let selectedDays=3;
const dayButtons=document.querySelectorAll('.day-btn');
dayButtons.forEach(btn=>{
  btn.addEventListener('click',()=>{
    dayButtons.forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
    selectedDays=parseInt(btn.dataset.days);
  });
});

// í‚¤ì›Œë“œ ì„ íƒ
const keywordButtons=document.querySelectorAll('#keywordBox button');
keywordButtons.forEach(btn=>{
  btn.addEventListener('click',()=>{
    btn.classList.toggle('active');
  });
});

// ì½”ìŠ¤ ìƒì„±
document.getElementById('plannerGenerate').addEventListener('click',()=>{
  const selected=Array.from(keywordButtons)
    .filter(b=>b.classList.contains('active'))
    .map(b=>b.dataset.key);
  
  if(selected.length===0){
    document.getElementById('plannerResult').innerHTML='<p style="color:var(--accent);margin-top:10px;padding:15px;background:rgba(230,57,70,0.1);border-radius:10px;text-align:center">âš ï¸ í•˜ë‚˜ ì´ìƒì˜ ì—¬í–‰ í…Œë§ˆë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.</p>';
    return;
  }

  const courseDB={
    ì „í†µ:['ì„¼ì†Œì§€Â·ë‚˜ì¹´ë¯¸ì„¸ ì‚°ì±…','ë©”ì´ì§€ì‹ ê¶ ì°¸ë°°','í™©ê±° ì™¸ì› ì‚°ì±…','ìš°ì—ë…¸ ê³µì›Â·ë„ì¿„êµ­ë¦½ë°•ë¬¼ê´€'],
    ì•¼ê²½:['ë„ì¿„ ìŠ¤ì¹´ì´íŠ¸ë¦¬ ì „ë§ëŒ€','ë„ì¿„íƒ€ì›Œ ì•¼ê²½','ì‹œë¶€ì•¼ ìŠ¤ì¹´ì´','ë¡¯í°ê¸°íìŠ¤ ì „ë§ëŒ€','ì˜¤ë‹¤ì´ë°” í•´ë³€'],
    ì‡¼í•‘:['ì‹œë¶€ì•¼ 109Â·ì„¼í„°ê°€ì´','í•˜ë¼ì£¼ì¿  ë‹¤ì¼€ì‹œíƒ€ê±°ë¦¬','ê¸´ì ëª…í’ˆê±°ë¦¬','ì‹ ì£¼ì¿  ì´ì„¸íƒ„Â·ë£¨ë¯¸ë„¤','ì•„í‚¤í•˜ë°”ë¼ ì „ììƒê°€'],
    ìì—°:['ìš”ìš”ê¸° ê³µì› ì‚°ì±…','ì‹ ì£¼ì¿  êµì—”','ìš°ì—ë…¸ ê³µì›','ìŠ¤ë¯¸ë‹¤ ê³µì›'],
    ìŒì‹:['ì¸ í‚¤ì§€ ì¥ì™¸ì‹œì¥ ë§›ì§‘íˆ¬ì–´','ì´ìì¹´ì•¼ ê±°ë¦¬ íƒë°©','ë¼ë©˜ ë§›ì§‘ íˆ¬ì–´','ìŠ¤ì‹œ ì˜¤ë§ˆì¹´ì„¸ ì²´í—˜'],
    ì˜ˆìˆ :['ëª¨ë¦¬ë¯¸ìˆ ê´€','ë„ì¿„êµ­ë¦½ë°•ë¬¼ê´€','ì§€ë¸Œë¦¬ë¯¸ìˆ ê´€','íŒ€ë© ë³´ë”ë¦¬ìŠ¤'],
    ì•¡í‹°ë¹„í‹°:['ë””ì¦ˆë‹ˆëœë“œ/ë””ì¦ˆë‹ˆì”¨','ìœ ë‹ˆë²„ì„¤ ìŠ¤íŠœë””ì˜¤','ë„ì¿„ë”ì‹œí‹°','ì¡°ì¡°ì§€ ìŠ¤ì¹´ì´ë‹¤ì´ë¹™']
  };

  let allActivities=[];
  selected.forEach(key=>{
    if(courseDB[key]){
      allActivities=allActivities.concat(courseDB[key]);
    }
  });

  allActivities=[...new Set(allActivities)];

  const itemsPerDay=Math.ceil(allActivities.length/selectedDays);
  let html='<div style="margin-top:15px"><h4 style="color:var(--primary);margin-bottom:10px">ğŸ‰ ìƒì„±ëœ ë§ì¶¤ ì½”ìŠ¤</h4><table class="planner-table">';
  
  for(let day=1;day<=selectedDays;day++){
    const start=(day-1)*itemsPerDay;
    const end=Math.min(start+itemsPerDay,allActivities.length);
    const dayActivities=allActivities.slice(start,end);
    const activities=dayActivities.length>0?dayActivities.join(' â†’ '):'ììœ  ì¼ì •';
    html+=`<tr><th>${day}ì¼ì°¨</th><td>${activities}</td></tr>`;
  }
  
  html+=`</table>
    <div style="margin-top:15px;padding:12px;background:rgba(90,168,151,0.08);border-radius:10px;font-size:13px;color:var(--muted)">
      ğŸ’¡ Tip: ì¼ì •ì€ ì°¸ê³ ìš©ì´ë©°, ì‹¤ì œ ì´ë™ì‹œê°„ê³¼ ê°œì¸ ì¼ì •ì— ë§ì¶° ì¡°ì •í•˜ì„¸ìš”.
    </div>
    <button onclick="saveCourse()" style="margin-top:10px;border:none;background:var(--primary);color:#fff;padding:8px 16px;border-radius:16px;cursor:pointer;font-size:13px;transition:all .3s">ğŸ“¥ ì½”ìŠ¤ ì €ì¥í•˜ê¸°</button>
  </div>`;
  
  document.getElementById('plannerResult').innerHTML=html;
});

// ì½”ìŠ¤ ì €ì¥ ê¸°ëŠ¥
function saveCourse(){
  const result=document.getElementById('plannerResult').innerText;
  localStorage.setItem('tokyoSavedCourse',result);
  alert('âœ… ì—¬í–‰ ì½”ìŠ¤ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!\n\nì €ì¥ëœ ì½”ìŠ¤ëŠ” ë¸Œë¼ìš°ì €ì— ë³´ê´€ë˜ë©°, ë‹¤ì‹œ ë°©ë¬¸í•˜ì‹œë©´ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
}

// ì¹´ë“œ ì• ë‹ˆë©”ì´ì…˜
const cards=document.querySelectorAll('.card');
const observer=new IntersectionObserver(entries=>{
  entries.forEach(entry=>{
    if(entry.isIntersecting){
      entry.target.classList.add('visible');
      observer.unobserve(entry.target);
    }
  });
},{threshold:0.2});
cards.forEach(card=>observer.observe(card));

// ê²€ìƒ‰
const input=document.getElementById('searchInput');
const suggestions=document.getElementById('suggestions');
const places=[
  {name:'ì„¼ì†Œì§€',id:'sensoji'},
  {name:'ë„ì¿„ ìŠ¤ì¹´ì´íŠ¸ë¦¬',id:'skytree'},
  {name:'ì‹œë¶€ì•¼ êµì°¨ë¡œ',id:'shibuya'}
];
input.addEventListener('input',()=>{
  const v=input.value.trim();
  suggestions.innerHTML='';
  if(v===''){suggestions.style.display='none';return;}
  const f=places.filter(p=>p.name.includes(v));
  if(f.length>0){
    f.forEach(p=>{
      const d=document.createElement('div');
      d.textContent=p.name;
      d.onclick=()=>{showDetail(p.id);suggestions.style.display='none';input.value='';};
      suggestions.appendChild(d);
    });
  }else{
    const noResult=document.createElement('div');
    noResult.textContent='ê²€ìƒ‰ê²°ê³¼ ì—†ìŒ';
    noResult.style.color='#999';
    noResult.style.textAlign='center';
    noResult.style.padding='10px 0';
    suggestions.appendChild(noResult);
  }
  suggestions.style.display='block';
});
input.addEventListener('keypress',e=>{
  if(e.key==='Enter'){
    const first=suggestions.querySelector('div');
    if(first&&first.textContent!=='ê²€ìƒ‰ê²°ê³¼ ì—†ìŒ')first.click();
  }
});
document.addEventListener('click',e=>{
  if(!input.contains(e.target)&&!suggestions.contains(e.target))suggestions.style.display='none';
});

// íŒ¨ë„ ë°ì´í„°
const panel=document.getElementById('detailPanel');
const panelOverlay=document.getElementById('panelOverlay');
const content=document.getElementById('detailContent');
let currentId='';

const details={
  sensoji:{
    title:'ì„¼ì†Œì§€',
    subtitle:'ë„ì¿„ì˜ ì „í†µì„ ê°„ì§í•œ ì•„ì‚¬ì¿ ì‚¬ì˜ ìƒì§• ì‚¬ì°°',
    img:'tokyoimages/sensoji.jpg',
    summary:'ì„¼ì†Œì§€ëŠ” ë„ì¿„ì—ì„œ ê°€ì¥ ì˜¤ë˜ëœ ì‚¬ì°° ì¤‘ í•˜ë‚˜ë¡œ, 628ë…„ì— ì°½ê±´ë˜ì–´ 1,400ë…„ ì´ìƒì˜ ì—­ì‚¬ë¥¼ ìë‘í•©ë‹ˆë‹¤. ì¹´ë¯¸ë‚˜ë¦¬ëª¬ì˜ ê±°ëŒ€í•œ ë¶‰ì€ ë“±ë¡±ì´ ìƒì§•ì´ë©°, ë‚˜ì¹´ë¯¸ì„¸ ìƒì ê°€ì—ì„œëŠ” ì „í†µ ê¸°ë…í’ˆê³¼ ì¼ë³¸ ì „í†µ ê°„ì‹ì„ ì¦ê¸¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.',
    info:{
      location:'ë„ì¿„ ë‹¤ì´í† êµ¬ ì•„ì‚¬ì¿ ì‚¬',
      time:'24ì‹œê°„ ê°œë°© (ë³¸ë‹¹ 06:00-17:00)',
      price:'ë¬´ë£Œ',
      duration:'1-2ì‹œê°„'
    },
    coords:{lat:35.7148,lng:139.7967},
    link:'sensoji.html'
  },
  skytree:{
    title:'ë„ì¿„ ìŠ¤ì¹´ì´íŠ¸ë¦¬',
    subtitle:'ë„ì¿„ ì „ê²½ì„ í•œëˆˆì— ë³¼ ìˆ˜ ìˆëŠ” ì¼ë³¸ ìµœê³  ë†’ì´ì˜ íƒ€ì›Œ',
    img:'tokyoimages/skytree.jpg',
    summary:'ë„ì¿„ ìŠ¤ì¹´ì´íŠ¸ë¦¬ëŠ” ë†’ì´ 634ë¯¸í„°ë¡œ ì¼ë³¸ì—ì„œ ê°€ì¥ ë†’ì€ êµ¬ì¡°ë¬¼ì…ë‹ˆë‹¤. ì „ë§ëŒ€ëŠ” 350mì™€ 450m ë‘ ì¸µìœ¼ë¡œ êµ¬ì„±ë˜ì–´ ìˆìœ¼ë©°, ë‚ ì”¨ê°€ ì¢‹ì€ ë‚ ì—ëŠ” í›„ì§€ì‚°ê¹Œì§€ ì¡°ë§í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. íŠ¹íˆ ì¼ëª° ì‹œê°„ëŒ€ì— ë°©ë¬¸í•˜ë©´ ë‚®ê³¼ ë°¤ì˜ ë„ì¿„ë¥¼ ëª¨ë‘ ê°ìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.',
    info:{
      location:'ë„ì¿„ ìŠ¤ë¯¸ë‹¤êµ¬',
      time:'10:00-21:00',
      price:'2,100ì—”~3,100ì—”',
      duration:'2-3ì‹œê°„'
    },
    coords:{lat:35.7101,lng:139.8107},
    link:'skytree.html'
  },
  shibuya:{
    title:'ì‹œë¶€ì•¼ êµì°¨ë¡œ',
    subtitle:'ì ŠìŒì˜ ì¤‘ì‹¬ì§€, ì„¸ê³„ì—ì„œ ê°€ì¥ ë¶ë¹„ëŠ” ìŠ¤í¬ë¨ë¸” êµì°¨ë¡œ',
    img:'tokyoimages/shibuya.jpg',
    summary:'ì‹œë¶€ì•¼ ìŠ¤í¬ë¨ë¸” êµì°¨ë¡œëŠ” í•œ ë²ˆì— ìµœëŒ€ 3,000ëª…ì´ ë™ì‹œì— ê±´ë„ˆëŠ” ì„¸ê³„ì—ì„œ ê°€ì¥ ë¶ë¹„ëŠ” êµì°¨ë¡œì…ë‹ˆë‹¤. ì£¼ë³€ì—ëŠ” ì‹œë¶€ì•¼ 109, ë§ˆë£¨ì´, íŒŒë¥´ì½” ë“± ìœ ëª… ì‡¼í•‘ëª°ì´ ë°€ì§‘í•´ ìˆìœ¼ë©°, ì €ë… ì‹œê°„ëŒ€ì˜ ë„¤ì˜¨ì‚¬ì¸ê³¼ ëŒ€í˜• ì „ê´‘íŒì´ ë§Œë“¤ì–´ë‚´ëŠ” ë„ì¿„ íŠ¹ìœ ì˜ í™”ë ¤í•œ ë¶„ìœ„ê¸°ë¥¼ ê²½í—˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.',
    info:{
      location:'ë„ì¿„ ì‹œë¶€ì•¼êµ¬',
      time:'24ì‹œê°„',
      price:'ë¬´ë£Œ',
      duration:'1-3ì‹œê°„'
    },
    coords:{lat:35.6595,lng:139.7005},
    link:'shibuya.html'
  }
};

function showDetail(id){
  const detail=details[id];
  if(!detail)return;

  const mapUrl=`https://www.google.com/maps?q=${detail.coords.lat},${detail.coords.lng}&hl=ko&z=15&output=embed`;

  const html=`
    <h2>${detail.title}</h2>
    <div class="detail-sub">${detail.subtitle}</div>
    <div style="width:100%;height:260px;border-radius:14px;margin:8px 0 15px;box-shadow:var(--shadow);overflow:hidden">
      <iframe src="${mapUrl}"
        style="width:100%;height:100%;border:0"
        loading="lazy"
        referrerpolicy="no-referrer-when-downgrade"></iframe>
    </div>
    <p class="detail-summary">${detail.summary}</p>
    <div class="detail-info">
      <div class="info-item">
        <strong>ğŸ“ ìœ„ì¹˜</strong>
        <span>${detail.info.location}</span>
      </div>
      <div class="info-item">
        <strong>ğŸ• ìš´ì˜ì‹œê°„</strong>
        <span>${detail.info.time}</span>
      </div>
      <div class="info-item">
        <strong>ğŸ’° ì…ì¥ë£Œ</strong>
        <span>${detail.info.price}</span>
      </div>
      <div class="info-item">
        <strong>â±ï¸ ì†Œìš”ì‹œê°„</strong>
        <span>${detail.info.duration}</span>
      </div>
    </div>
    <div class="detail-buttons">
      <button class="detail-btn close" onclick="closePanel()">â† ëŒì•„ê°€ê¸°</button>
      <a href="${detail.link}" class="detail-btn more">ìƒì„¸ë³´ê¸° â†’</a>
    </div>
  `;
  
  content.innerHTML=html;
  panel.classList.add('show');
  panelOverlay.classList.add('show');
  currentId=id;
  document.body.style.overflow='hidden';
}

function closePanel(){
  panel.classList.remove('show');
  panelOverlay.classList.remove('show');
  currentId='';
  document.body.style.overflow='';
}

function cardClick(event,id){
  const target=event.target;
  if(target.classList.contains('bookmark'))return;
  showDetail(id);
}

// ESC í‚¤ë¡œ íŒ¨ë„ ë‹«ê¸°
document.addEventListener('keydown',e=>{
  if(e.key==='Escape'&&panel.classList.contains('show')){
    closePanel();
  }
});

// ì¦ê²¨ì°¾ê¸°
let favorites=JSON.parse(localStorage.getItem('tokyoFavorites')||'[]');
const bookmarkButtons=document.querySelectorAll('.bookmark');

function updateBookmarksUI(){
  bookmarkButtons.forEach(btn=>{
    const id=btn.dataset.id;
    if(favorites.includes(id))btn.classList.add('active');
    else btn.classList.remove('active');
  });
  updateStats();
}
updateBookmarksUI();

bookmarkButtons.forEach(btn=>{
  btn.addEventListener('click',e=>{
    e.stopPropagation();
    const id=btn.dataset.id;
    if(favorites.includes(id)){
      favorites=favorites.filter(f=>f!==id);
    }else{
      favorites.push(id);
    }
    localStorage.setItem('tokyoFavorites',JSON.stringify(favorites));
    updateBookmarksUI();
  });
});

// ì¦ê²¨ì°¾ê¸° í•„í„° í•¨ìˆ˜
function filterFavorites(){
  const filterButtons=document.querySelectorAll('.filter-bar button');
  filterButtons.forEach(b=>b.classList.remove('active'));
  cards.forEach(card=>{
    const id=card.dataset.id;
    card.style.display=favorites.includes(id)?'block':'none';
  });
}

// ë¦¬ë·°: íŒ¨ë„ ì•ˆì—ì„œ ëª¨ë“  ìƒì„¸ í˜ì´ì§€ ë¦¬ë·°ë¥¼ í†µí•©í•´ì„œ ë³´ì—¬ì£¼ë„ë¡ êµ¬í˜„
function showMyReviews(){
  const reviews = JSON.parse(localStorage.getItem('tokyoReviews')) || [];

  let html = `<h2 style="margin-bottom:15px;color:var(--primary)">ğŸ“ ì‘ì„±ëœ ë¦¬ë·° (${reviews.length}ê°œ)</h2>`;

  if (reviews.length === 0) {
    html += `<p style="text-align:center;padding:40px;color:var(--muted)">
      ì•„ì§ ì‘ì„±ëœ ë¦¬ë·°ê°€ ì—†ìŠµë‹ˆë‹¤.<br>
      ì„¼ì†Œì§€Â·ìŠ¤ì¹´ì´íŠ¸ë¦¬Â·ì‹œë¶€ì•¼ ë“± ìƒì„¸ í˜ì´ì§€ì—ì„œ ë¦¬ë·°ë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”.
    </p>`;
  } else {
    // ë‚ ì§œ ë¬¸ìì—´ì´ "YYYY.MM.DD" ë˜ëŠ” "YYYY. M. D" ë“± ë‹¤ì–‘í•  ìˆ˜ ìˆìœ¼ë‹ˆ Date íŒŒì‹± ì‹œ ì•ˆì „í•˜ê²Œ ì²˜ë¦¬
    reviews.sort((a, b) => {
      const da = new Date(a.date);
      const db = new Date(b.date);
      return db - da;
    });

    html += reviews.map(r => `
      <div class="review-item">
        <h4>${r.place}</h4>
        <p>ë³„ì : ${'â˜…'.repeat(Number(r.rating))}${'â˜†'.repeat(5 - Number(r.rating))}</p>
        <p>ì‘ì„±ì: ${r.nickname}</p>
        <p>${r.content}</p>
        <small>${r.date}</small>
      </div>
    `).join('');
  }

  html += `
    <div class="detail-buttons" style="margin-top:25px">
      <button class="detail-btn close" onclick="closePanel()" style="max-width:100%">â† ëŒì•„ê°€ê¸°</button>
    </div>
  `;

  content.innerHTML = html;
  panel.classList.add('show');
  panelOverlay.classList.add('show');
  document.body.style.overflow = 'hidden';
  currentId = 'reviews';
}

// í•„í„°
const filterButtons=document.querySelectorAll('.filter-bar button');
filterButtons.forEach(btn=>{
  btn.addEventListener('click',()=>{
    const category=btn.dataset.filter;
    filterButtons.forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
    cards.forEach(card=>{
      const cardCat=card.dataset.category;
      let show=false;
      if(category==='all')show=true;
      else if(category===cardCat)show=true;
      card.style.display=show?'block':'none';
    });
  });
});

// í†µê³„ ì—…ë°ì´íŠ¸ (ë¦¬ë·° ê°œìˆ˜ ë°˜ì˜)
function updateStats(){
  const favEl=document.getElementById('favoriteCount');
  const revEl=document.getElementById('reviewCount');
  const favorites = JSON.parse(localStorage.getItem('tokyoFavorites') || '[]');
  const reviews = JSON.parse(localStorage.getItem('tokyoReviews') || '[]');
  if(favEl)favEl.textContent=favorites.length;
  if(revEl)revEl.textContent=reviews.length;
}
updateStats();
</script>

</body>
</html>
